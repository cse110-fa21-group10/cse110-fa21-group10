name: Lint

on: [pull_request]

jobs:
  eslint:
    name: runner / eslint
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [10.x]

    steps:
      - uses: actions/checkout@v1
        with:
          fetch-depth: 1

      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v1
        with:
          node-version: ${{ matrix.node-version }}

      - name: npm login
        run:
          npm config set //registry.npmjs.org/:_authToken=$NPM_READONLY_AUTH_TOKEN
        env:
          NPM_READONLY_AUTH_TOKEN: ${{ secrets.NPM_READONLY_AUTH_TOKEN }}

      - name: npm install
        working-directory: ./source
        run: npm i --ignore-scripts

      - name: Run ESLint
        uses: ninosaurus/eslint-check@v5
        with:
          eslint-config-path: "./.eslintrc.js"
          custom-directory: "./source"
          repo-token: ${{secrets.GITHUB_TOKEN}}

    # runs-on: ubuntu-latest
    # steps:
    #   - uses: actions/checkout@v2
      # - uses: reviewdog/action-eslint@v1
      #   with:
      #     reporter: github-pr-review # Change reporter.
      #     eslint_flags: './source'

# jobs:
#   eslint:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@v1
#       - uses: stefanoeb/eslint-action@1.0.2
#         with:
#           files: source/