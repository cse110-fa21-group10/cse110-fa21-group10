<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Recipe Site</title>


  <!-- Main Stylesheet & Scripts -->
  <link rel="stylesheet" href="recipe-page.css" />
</head>

<body>
  <main>

    <div class="recipe">
      <img class= "logo" src="pixie.png" alt="pixie">
    </div>
    <script>
      
      let recipes = [
        'recipes/batetaPoha.json',
        'recipes/ButternutSquashFrittata.json',
        'recipes/vietnamesePancakes.json',
        'recipes/lentilSoup.json',
        'recipes/mushroomtofusoup.json',
        'recipes/thaitofu.json',
        'recipes/jambalaya.json',
        'recipes/riceSalad.json',
        'recipes/nigeriansnailstew.json',
        'recipes/gingerbeefbroccoli.json',
        'recipes/beefstew.json',
        'recipes/stuffedpepper.json'
      ];
      const recipeURL = '../assets/recipes/sample-recipe.json'
      //get recipe data from json file
      const params = new URLSearchParams(window.location.search);
      const s = params.get("s");
      const existingRecs = JSON.parse(window.localStorage.getItem('recommendations'));
      
      if(s == "-1" || s == null){
        addData(JSON.parse(window.localStorage.getItem('queryResult'))[0]);
      }else if(existingRecs){
        addData(existingRecs[parseInt(s)]);
      }else{
        fetch(recipes[parseInt(s)])
            .then(response => response.json())
            .then(data => {
              addData(data)
            })
            .catch(error => {
                console.log(error);
                reject(false);
            })
        
        
      }
      
      


      function addData(recipeData) {
        let recipe = document.querySelector('.recipe');

        let title = document.createElement('h1');
        title.classList.add('title');
        title.innerHTML = recipeData.title;
        recipe.appendChild(title);

        let overview = document.createElement('div');
        overview.classList.add('recipe-overview');

        let description = document.createElement('p');
        description.classList.add('recipe-description');
        description.innerHTML = recipeData.summary;
        overview.appendChild(description);

        let image = document.createElement('img');
        image.classList.add('recipe-image');
        image.setAttribute('src', recipeData.image);
        image.setAttribute('alt', 'recipe-image');

        overview.appendChild(image);
      
        recipe.appendChild(overview);

        let time = document.createElement('p');
        time.classList.add('cook-time');
        time.innerHTML = '<b>Cook Time: </b>' + recipeData.readyInMinutes + ' Minutes';
        recipe.appendChild(time);

        let ingred = document.createElement('h2');
        ingred.classList.add('ingr_title');
        ingred.innerHTML = "Ingredients";
        recipe.appendChild(ingred);

        let ingredients = document.createElement('ul');
        for(let i = 0; i < recipeData.extendedIngredients.length; i++) {
          let ingredient = document.createElement('li');
          ingredient.innerHTML = recipeData.extendedIngredients[i]['original'];
          ingredients.appendChild(ingredient);
        }
        recipe.appendChild(ingredients);

        let steps_title = document.createElement('h2');
        steps_title.classList.add('steps_title');
        steps_title.innerHTML = "Recipe Steps";
        recipe.appendChild(steps_title);

        let steps = document.createElement('div');
        steps.classList.add('recipe-steps');
        steps.innerHTML = recipeData.instructions;
        recipe.appendChild(steps);
      }
    </script>
  </main>
</body>

</html>